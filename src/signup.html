<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign up!</title>
    <link rel="stylesheet" href="signup.css">
</head>

<body>
    <h1>Sign up here!</h1>

    <div class="container1">
        <form name="signup">
            <input type="text" name="email" id="email" placeholder="Enter your email ID">

            <input type="password" name="password" id="password" placeholder="Set password">

            <div class="submit-div">
                <input type="submit" id="signup" value="Sign up" onclick="register()">
                <input type="submit" value="Login">
            </div>

        </form>
    </div>

    <h2>
        Go to <a href="/home.html">app</a>
    </h2>

    <script type="text/javascript">


    </script>

</body>
<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCzIXsEUSqFitrKzIhUe9po2_9HeqvZAd0",
        authDomain: "practice-a7c08.firebaseapp.com",
        databaseURL: "https://practice-a7c08-default-rtdb.firebaseio.com",
        projectId: "practice-a7c08",
        storageBucket: "practice-a7c08.appspot.com",
        messagingSenderId: "488437262510",
        appId: "1:488437262510:web:2d6390b6833ca16e34253f"
    };

    const app = firebase.initializeApp(firebaseConfig);
    console.log(app);

    const auth =  firebase.auth()
    const database = firebase.database()
    console.log(auth);
    function register() {
        email = document.getElementById("email").value;
        password = document.getElementById("password").value;

        if(validate_email(email) == false || validate_password(password) == false) {
            alert('email or password is outta line')
        }
        
        auth.createUserWithEmailAndPassword(email,password)
        .then(function() {
            var user = auth.currentUser;

            var database_ref = database.ref()

            var user_data = {
                email:email,
                last_login:Date.now()
            }

            database_ref.child('users/' + user.uid).set(user_data)

            alert('user created')
        })
        .catch(function(error) {
            var error_code = error.code;
            var error_message = error.message;

            console.log(`${error_code} & ${error_message}`);

            alert(error_message)
        })
    }

</script>

</html>